<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ - Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="login-page">
    <div class="login-container">
        <div class="login-card">
            <div class="login-header">
                <div class="logo">
                    <i class="fas fa-chart-line"></i>
                    <span>Money Manager</span>
                </div>
                <h1>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</h1>
                <p>Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</p>
            </div>

            <form id="loginForm">
                <div class="form-group">
                    <label for="email">
                        <i class="fas fa-envelope"></i>
                        Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
                    </label>
                    <input type="email" id="email" required 
                           placeholder="employee@example.com">
                </div>

                <div class="form-group">
                    <label for="password">
                        <i class="fas fa-lock"></i>
                        ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
                    </label>
                    <input type="password" id="password" required 
                           placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                </div>

                <button type="submit" class="btn btn-primary btn-block">
                    <i class="fas fa-sign-in-alt"></i>
                    ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                </button>

                <div class="login-footer">
                    <p class="error-message" id="errorMessage"></p>
                    <p>Ù„Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† ÙÙ‚Ø·</p>
                    
                    <!-- Ø²Ø± Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ø³Ø±ÙŠØ¹Ø© -->
                    <button type="button" class="btn-help" id="quickHelpBtn" 
                            style="margin-top: 15px; background: #f8f9fa; border: 1px solid #ddd; padding: 8px 15px; border-radius: 5px; cursor: pointer; width: 100%;">
                        <i class="fas fa-magic"></i> Ù…Ø³Ø§Ø¹Ø¯Ø© Ø³Ø±ÙŠØ¹Ø©: Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¯ÙŠØ± ØªØ¬Ø±ÙŠØ¨ÙŠ
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore.js"></script>
    
    <!-- Ù…Ù„ÙØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù… -->
    <script src="firebase-config.js"></script>
    <script src="auth.js"></script>
    <script>
        // ØªÙ‡ÙŠØ¦Ø© Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = new AuthSystem();

        // Ù…Ø¹Ø§Ù„Ø¬Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const errorMessage = document.getElementById('errorMessage');
            
            const result = await auth.login(email, password);
            
            if (result.success) {
                window.location.href = 'dashboard.html';
            } else {
                errorMessage.textContent = result.error;
            }
        });

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        firebase.auth().onAuthStateChanged((user) => {
            if (user) {
                window.location.href = 'dashboard.html';
            }
        });

        // Ø²Ø± Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ø³Ø±ÙŠØ¹Ø© - Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¯ÙŠØ± ØªØ¬Ø±ÙŠØ¨ÙŠ
        document.getElementById('quickHelpBtn').addEventListener('click', async function() {
            const email = 'admin@moneymanager.com';
            const password = 'Admin@1234';
            const errorMessage = document.getElementById('errorMessage');
            
            // ØªØºÙŠÙŠØ± Ù†Øµ Ø§Ù„Ø²Ø± Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªÙ†ÙÙŠØ°
            const originalText = this.innerHTML;
            this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡...';
            this.disabled = true;
            
            try {
                errorMessage.textContent = 'Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¯ÙŠØ±...';
                
                // 1. Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ ÙÙŠ Authentication
                const userCredential = await firebase.auth().createUserWithEmailAndPassword(email, password);
                const uid = userCredential.user.uid;
                
                errorMessage.textContent = 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ØŒ Ø¬Ø§Ø±ÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...';
                
                // 2. Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù ÙÙŠ Firestore Ø¨Ù†ÙØ³ Ø§Ù„Ù€ UID
                await firebase.firestore().collection('employees').doc(uid).set({
                    name: 'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ',
                    email: email,
                    phone: '+966501234567',
                    role: 'Ù…Ø¯ÙŠØ±',
                    status: 'active',
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                errorMessage.textContent = 'âœ… ØªÙ…! ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹...';
                
                // 3. Ù…Ù„Ø¡ Ø§Ù„Ø­Ù‚ÙˆÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
                document.getElementById('email').value = email;
                document.getElementById('password').value = password;
                
                // 4. ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ 2 Ø«Ø§Ù†ÙŠØ©
                setTimeout(async () => {
                    try {
                        const result = await auth.login(email, password);
                        if (result.success) {
                            window.location.href = 'dashboard.html';
                        } else {
                            errorMessage.textContent = 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ: ' + result.error;
                        }
                    } catch (loginError) {
                        errorMessage.textContent = 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø¨Ù€: ' + email + ' / ' + password;
                    }
                    
                    // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø²Ø± Ù„Ø­Ø§Ù„ØªÙ‡ Ø§Ù„Ø£ØµÙ„ÙŠØ©
                    this.innerHTML = originalText;
                    this.disabled = false;
                }, 2000);
                
            } catch (error) {
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø­Ø³Ø§Ø¨ Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹ Ø¨Ø§Ù„ÙØ¹Ù„
                if (error.code === 'auth/email-already-in-use') {
                    errorMessage.textContent = 'âœ… Ø§Ù„Ø­Ø³Ø§Ø¨ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„. Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ø¨Ù€: ' + email + ' / ' + password;
                    document.getElementById('email').value = email;
                    document.getElementById('password').value = password;
                } else {
                    errorMessage.textContent = 'Ø®Ø·Ø£: ' + error.message;
                }
                
                // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø²Ø± Ù„Ø­Ø§Ù„ØªÙ‡ Ø§Ù„Ø£ØµÙ„ÙŠØ©
                this.innerHTML = originalText;
                this.disabled = false;
            }
        });

        // Ø²Ø± Ø§Ø®ØªØ¨Ø§Ø±ÙŠ Ø¥Ø¶Ø§ÙÙŠ ÙÙŠ Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„
        console.log('%cğŸ® Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø·ÙˆØ± Ù…ØªØ§Ø­Ø©!', 'color: #018159; font-size: 14px; font-weight: bold;');
        console.log('%cÙ„Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¯ÙŠØ± Ø³Ø±ÙŠØ¹Ø§Ù‹ØŒ Ø§ÙØªØ­ Console (F12) ÙˆØ§Ù„ØµÙ‚:', 'color: #666;');
        console.log(`
// ÙƒÙˆØ¯ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¯ÙŠØ± Ø³Ø±ÙŠØ¹
async function createAdmin() {
  try {
    const user = await firebase.auth().createUserWithEmailAndPassword("admin@test.com", "Test@1234");
    await firebase.firestore().collection("employees").doc(user.user.uid).set({
      name: "Ø§Ù„Ù…Ø¯ÙŠØ±",
      email: "admin@test.com",
      role: "Ù…Ø¯ÙŠØ±",
      phone: "0500000000",
      status: "active"
    });
    console.log("âœ… ØªÙ…! Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ø¨Ù€ admin@test.com / Test@1234");
  } catch(e) {
    console.log("Ø§Ù„Ø­Ø³Ø§Ø¨ Ù…ÙˆØ¬ÙˆØ¯ØŒ Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ù…Ø¨Ø§Ø´Ø±Ø©");
  }
}
createAdmin();
        `);
    </script>
</body>
</html>
